library(lme4)
library(MuMIn)
#define the function for overdispersion test
overdisp_fun <- function(model) {
rdf <- df.residual(model)
rp <- residuals(model,type="pearson")
Pearson.chisq <- sum(rp^2)
prat <- Pearson.chisq/rdf
pval <- pchisq(Pearson.chisq, df=rdf, lower.tail=FALSE)
c(chisq=Pearson.chisq,ratio=prat,rdf=rdf,p=pval)
}
#load data
data = read.csv("c-fos.csv")
options(na.action = "na.fail")
#set data as nominal type
data$Time <- as.factor(data$Time)
data$Sham <- as.factor(data$Sham)
data$Ipsi <- as.factor(data$Ipsi)
data$Distance2 <- as.factor(data$Distance2) #distance2 is nominal data 1,2,3,4,5
#distance1 is re-formed value 0,1,2, labeing the relative distance from small to large
#so distance1 is not redefined as nominal type, data$Distance1 <- as.factor(data$Distance1)
data$AnimalNo <- as.factor(data$AnimalNo)
#split data for 90min, 24hrs, and 48hrs
time1 <- as.data.frame(data[data$Time=="1",])
time2 <- as.data.frame(data[data$Time=="2",])
time3 <- as.data.frame(data[data$Time=="3",])
